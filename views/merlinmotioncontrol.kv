<BackgroundColor@Widget>
    background_color: .15, .15, .15, 1
    canvas.before:
        Color:
            rgba: root.background_color
        Rectangle:
            size: self.size
            pos: self.pos

<CustomButton@Button>:
    font_size: root.height*0.2
    color: 0,0,0,1
    background_normal: ''
    background_color: .88, .88, .88, 1

<SettingsButton@Button>:
    font_size: root.height*0.35
    color: 0.9,0.9,0.9,1
    foreground_color: .1,.1,.1,1
    background_normal: ''
    background_color: .18, .18, .18, 1

<ModalButton@Button>:
    font_size: 16
    color: 0,0,0,1
    background_normal: ''
    #background_color: .88, .88, .88, 1

<CustomTextInput@TextInput>:
    font_size: root.height*0.3
    background_color: .2, .2, .2, 1
    foreground_color: .91, .91, .91, 1
    cursor_color: 1, 1, 1, 1
    hint_text: 'Heading'
    multiline: False
    padding: [20,root.height*0.3,0,0]
    spacing:[0, 0, 20, 0]

<ModalTextInput@TextInput>:
    id: modal
    font_size: root.height*0.3
    background_color: .2, .2, .2, 1
    foreground_color: 1, 1, 1, 1
    cursor_color: 1, 1, 1, 1
    hint_text: 'Heading'
    multiline: False
    padding: [10,root.height*0.32,0,0]

<CustomLabel@Label>:
    font_size: root.height*0.3

<ModalLabel@Label>:
    font_size: 20

<ActionButtons>:
    id: buttons
    rows: 2
    cols: 1
    spacing: 10
    padding: 10
    FloatLayout:
        size_hint: (1, .35)
        BoxLayout:
            orientation: 'vertical'
            spacing: 10
            padding: 10
            size_hint: (1, .5)
            pos_hint: {'x':.0, 'y':.5}
            CustomButton:
                text: "Standby"
                size_hint_x: None
                width: 200
                disabled: root.parent.parent.button_standby_disabled
                on_press: root.parent.parent.standby()
    FloatLayout:
        size_hint: (1, .65)
        BoxLayout:
            orientation: 'vertical'
            size_hint: (1, 1)
            pos_hint: {'x':.0, 'y':.0}
            spacing: 10
            padding: 10
            CustomButton:
                text: "Move in"
                size_hint_x: None
                width: 200
                disabled: root.parent.parent.button_move_in_disabled
                on_press: root.parent.parent.move_in()
            CustomButton:
                text: "Move out"
                size_hint_x: None
                width: 200
                disabled: root.parent.parent.button_move_out_disabled
                on_press: root.parent.parent.move_out()
            CustomButton:
                text: "Stop"
                size_hint_x: None
                width: 200
                disabled: root.parent.parent.button_stop_disabled
                on_press: root.parent.parent.stop()

<Labels>:
    rows: 7
    cols: 1
    spacing: 10
    padding: 0
    CustomLabel:
        text: "Connection Status"
    CustomLabel:
        text: "Requested State"
    CustomLabel:
        text: "Current State"
    CustomLabel:
        text: "Gatan In"
    CustomLabel:
        text: "Gatan Veto"
    CustomLabel:
        text: "Requested Position"
    CustomLabel:
        text: "Position"

<StatusFields>:
    rows: 7
    cols: 1
    spacing: 10
    padding: 0
    CustomLabel:
        id: conn_stat
        text: root.parent.parent.connection_status
        #background_color = root.parent.parent.
    CustomLabel:
        text: root.parent.parent.requested_state
    CustomLabel:
        text: root.parent.parent.current_state
    CustomLabel:
        text: root.parent.parent.gatan_in_msg
    CustomLabel:
        text: root.parent.parent.gatan_veto_msg
    CustomLabel:
        text: root.parent.parent.requested_position
    CustomLabel:
        text: root.parent.parent.rp

<ContainerGrid>:
    id: container
    canvas.before:
        Color:
            rgba: .22,.22,.22,1
        Rectangle:
            pos: self.pos
            size: self.size
    disabled: root.window_disabled
    ActionBar:
        size_hint: (1, .1)
        pos_hint: {'x':.0, 'y':0.9}
        pos_hint: {'top':1}
        ActionView:
            use_separator: True
            ActionPrevious:
                title: "Merlin Motion Control"
                with_previous: False
                app_icon: 'views/static/images/white_atom.png'
                app_icon_height: 40
                app_icon_width: 40
            ActionOverflow:
            ActionButton:
                text: "Info"
                size_hint_x: None
                width: 200
                on_press: root.infowindow()
            ActionButton:
                text: "Settings"
                size_hint_x: None
                width: 200
                on_press: root.settingswindow()
            ActionButton:
                text: "Test"
                size_hint_x: None
                width: 200
                on_press: root.testwindow()

    GridLayout:
        size_hint: (1, .9)
        pos_hint: {'x':.0, 'y':0.0}
        orientation: 'horizontal'
        cols: 3
        rows: 1
        ActionButtons:
        Labels:
        StatusFields:


<SettingsWindow>:
    size_hint: (None, None)
    size: (400, 440)
    FloatLayout:
        size: (400, 440)
        CustomLabel:
            size_hint: (1, .11)
            pos_hint: {'x':.0, 'y':.88}
            text: root.software_title + " v" + root.software_version
        GridLayout:
            size_hint: (1, .7)
            pos_hint: {'x':.0, 'y':.16}
            rows: 10
            cols: 2
            spacing: 10
            padding: 0
            CustomLabel:
                text: "IP Address"
            ModalTextInput:
                focus: False
                on_focus:
                    self.border_color=(.5,.5,.5,1)
                    self.cursor=(0,0)
                text: root.ip_address
                on_text:
                    root.ip_address=self.text
            CustomLabel:
                text: "Speed"
            ModalTextInput:
                focus: False
                on_focus:
                    self.border_color=(.5,.5,.5,1)
                    self.cursor=(0,0)
                text: root.speed
                on_text:
                    root.speed=self.text
            CustomLabel:
                text: "Speed Out"
            ModalTextInput:
                focus: False
                on_focus:
                    self.border_color=(.5,.5,.5,1)
                    self.cursor=(0,0)
                text: root.speed_out
                on_text:
                    root.speed_out=self.text
            CustomLabel:
                text: "Requested Position"
            ModalTextInput:
                id: req_pos
                focus: False
                on_focus:
                    self.border_color=(.5,.5,.5,1)
                    self.cursor=(0,0)
                text: root.requested_position
                on_text:
                    root.requested_position=self.text
            CustomLabel:
                text: "Standby Position"
            ModalTextInput:
                focus: False
                on_focus:
                    self.border_color=(.5,.5,.5,1)
                    self.cursor=(0,0)
                text: root.standby_position
                on_text:
                    root.standby_position=self.text

        ModalButton:
            size_hint: (.39, .12)
            pos_hint: {'x':.3, 'y':0.08}
            text: "Update values"
            on_press: root.set_values()

<InfoWindow>:
    size_hint: (None, None)
    size: (300, 150)
    BoxLayout:
        orientation: "vertical"
        Label:
            text: root.software_title + " v" + root.software_version
        Label:
            text: "Quantum Detectors Ltd. (c) " + root.copyright_date

<TestWindow>:
    size_hint: (None, None)
    size: (400, 200)
    FloatLayout:
        size: (400, 200)
        font_size: 20
        GridLayout:
            size_hint: (0.75, 1)
            pos_hint: {'x':.25, 'y':.0}
            rows: 4
            cols: 2
            Label:
                text: "Delay"
            ModalTextInput:
                focus: False
                on_focus:
                    self.border_color=(.5,.5,.5,1)
                    self.cursor=(0,0)
                text: root.delay
                on_text:
                    root.delay=self.text
                on_text_validate:
                    root.update_fields()
            Label:
                text: "Cycles"
            ModalTextInput:
                focus: False
                on_focus:
                    self.border_color=(.5,.5,.5,1)
                    self.cursor=(0,0)
                text: root.cycles
                on_text:
                    root.cycles=self.text
                on_text_validate:
                    root.update_fields()
            Label:
                text: "Estimated time"
            Label:
                text: root.total_test_time_label
            Label:
                text: "Time remaining"
            Label:
                text: root.time_remaining_label
        BoxLayout:
            orientation: "vertical"
            size_hint: (0.25, 1)
            pos_hint: {'x':.0, 'y':.0}
            Button:
                text: "Cycle"
            Button:
                text: "Abort"
